<?xml version="1.0"?>
<robot xmlns:xacro="http://ros.org/wiki/xacro">

  <xacro:include filename="$(find raw_description)/urdf/p_rob_arm/p_rob.transmission.xacro" />
  <xacro:include filename="$(find raw_description)/urdf/p_rob_arm/p_rob.gazebo.xacro" />
  <xacro:include filename="$(find cob_description)/urdf/common.xacro" />

  <xacro:property name="pi" value="3.14159265" />
	
  <!-- Inertia parameters -->
  <xacro:property name="mass" value="3.18818528911811" />  
	
  <xacro:property name="intertia_ixx" value="4.65436888537887" />  
  <xacro:property name="intertia_ixy" value="-0.0338576061896482" />
  <xacro:property name="intertia_ixz" value="3.29763186167614E-06" />
  <xacro:property name="intertia_iyy" value="0.165544422845209" />
  <xacro:property name="intertia_iyz" value="-0.00333281637307909" />
  <xacro:property name="intertia_izz" value="4.60911765357231" />

  <xacro:property name="origin_x" value="8.71294630254049E-05" />
  <xacro:property name="origin_y" value="0.508451295685675" />
  <xacro:property name="origin_z" value="-0.00113740271757783" />		


  <xacro:macro name="p_rob_arm" params="prefix
  		 joint1_lower_limit:=-2.44346	joint1_upper_limit:=2.44346		joint1_velocity_limit:=0.5
		 joint2_lower_limit:=-1.9	joint2_upper_limit:=1.9		joint2_velocity_limit:=0.5
		 joint3_lower_limit:=-1.9   joint3_upper_limit:=1.9		joint3_velocity_limit:=0.5
		 joint4_lower_limit:=-2.82743	joint4_upper_limit:=2.82743		joint4_velocity_limit:=0.5
		 joint5_lower_limit:=-1.9	joint5_upper_limit:=1.9		joint5_velocity_limit:=0.5
		 joint6_lower_limit:=-2.86233	joint6_upper_limit:=2.86233		joint6_velocity_limit:=0.5
		 gripper_lower_limit:=-2.4	gripper_upper_limit:=2.4	gripper_velocity_limit:=1.7453292519943295">


	<link name="arm_base_link">
		<visual>
			<origin xyz="0 0 0" rpy="0 0 0" />
			<geometry>
				<mesh filename="package://raw_description/meshes/p_rob_arm/base_link.STL"/>
			</geometry>
			<material name="">
				<color rgba="0.898039215686275 0.917647058823529 0.929411764705882 1.0"/>
			</material>
		</visual>
		<collision>
			<origin xyz="0 0 0" rpy="0 0 0" />
			<geometry>
				<mesh filename="package://raw_description/meshes/p_rob_arm/base_link.STL"/>
			</geometry>
		</collision>
		<inertial>
			<origin xyz="${origin_x} ${origin_y} ${origin_z}" rpy="0 0 0" />
			<mass value="${mass}"/>
			<inertia ixx="${intertia_ixx}" ixy="${intertia_ixy}" ixz="${intertia_ixz}" iyy="${intertia_iyy}" iyz="${intertia_iyz}" izz="${intertia_izz}"/>
		</inertial>    
	</link>	

	<joint name="${prefix}joint1" type="revolute">
		<parent link="arm_base_link" />
		<child link = "${prefix}link12" />
		<origin xyz="0 0 0.223" rpy="0.0 0.0 0.0" />
		<axis xyz="0 0 1" />
		<limit lower="${joint1_lower_limit}" upper="${joint1_upper_limit}" effort="1000.0" velocity="${joint1_velocity_limit}"/>
		<dynamics damping="0.0" friction="0.0"/>
	</joint>

	<link name="${prefix}link12">
		<visual>
			<origin xyz="0 0 0" rpy="${pi/2.0} 0 0" />
			<geometry>
				<mesh filename="package://raw_description/meshes/p_rob_arm/link12.STL"/>
			</geometry>
			<material name="">
				<color rgba="0.898039215686275 0.917647058823529 0.929411764705882 1.0"/>
			</material>
		</visual>
		<collision>
			<origin xyz="0 0 0" rpy="${pi/2.0} 0 0" />
			<geometry>
				<mesh filename="package://raw_description/meshes/p_rob_arm/link12.STL"/>
			</geometry>
		</collision>
		<inertial>
			<origin xyz="8.71294630254049E-05 0.277951295685675 -0.00113740271757783" rpy="0.0 0.0 0.0" />
			<mass value="${mass}"/>
			<inertia ixx="${intertia_ixx}" ixy="${intertia_ixy}" ixz="${intertia_ixz}" iyy="${intertia_iyy}" iyz="${intertia_iyz}" izz="${intertia_izz}"/>
		</inertial>    
	</link>	
    
	<joint name="${prefix}joint2" type="revolute">
		<parent link="${prefix}link12" />
		<child link = "${prefix}link23" />
		<origin xyz="0 0 0.1395" rpy="0.0 0.0 0.0" />
		<axis xyz="0 1 0" />
		<limit lower="${joint2_lower_limit}" upper="${joint2_upper_limit}" effort="1000.0" velocity="${joint2_velocity_limit}"/>
		<dynamics damping="0.0" friction="0.0"/>
	</joint>

	<link name="${prefix}link23">
		<visual>
			<origin xyz="0 0 0.145" rpy="${pi/2.0} 0 0" />
			<geometry>
				<mesh filename="package://raw_description/meshes/p_rob_arm/link23.STL"/>
			</geometry>
			<material name="">
				<color rgba="0.898039215686275 0.917647058823529 0.929411764705882 1.0"/>
			</material>
		</visual>
		<collision>
			<origin xyz="0 0 0.145" rpy="${pi/2.0} 0 0" />
			<geometry>
				<mesh filename="package://raw_description/meshes/p_rob_arm/link23.STL"/>
			</geometry>
		</collision>
		<inertial>
			<origin xyz="8.71294630254049E-05 0.000951295697065868 -0.00113740271757783" rpy="0.0 0.0 0.0" />
			<mass value="${mass}"/>
			<inertia ixx="${intertia_ixx}" ixy="${intertia_ixy}" ixz="${intertia_ixz}" iyy="${intertia_iyy}" iyz="${intertia_iyz}" izz="${intertia_izz}"/>
		</inertial>    
	</link>	
    
	<joint name="${prefix}joint3" type="revolute">
		<parent link="${prefix}link23" />
		<child link = "${prefix}link34" />
		<origin xyz="0 0 0.29" rpy="0.0 0.0 0.0" />
		<axis xyz="0 1 0" />
		<limit lower="${joint3_lower_limit}" upper="${joint3_upper_limit}" effort="1000.0" velocity="${joint3_velocity_limit}"/>
		<dynamics damping="0.0" friction="0.0"/>
	</joint>

	<link name="${prefix}link34">
		<visual>
			<origin xyz="0 0 0.1695" rpy="${pi/2.0} 0 0" />
			<geometry>
				<mesh filename="package://raw_description/meshes/p_rob_arm/link34.STL"/>
			</geometry>
			<material name="">
				<color rgba="0.898039215686275 0.917647058823529 0.929411764705882 1.0"/>
			</material>
		</visual>
		<collision>
			<origin xyz="0 0 0.1695" rpy="${pi/2.0} 0 0" />
			<geometry>
				<mesh filename="package://raw_description/meshes/p_rob_arm/link34.STL"/>
			</geometry>
		</collision>
		<inertial>
			<origin xyz="8.71294630254049E-05 -0.313548704302934 -0.00113740271757783" rpy="0.0 0.0 0.0" />
			<mass value="${mass}"/>
			<inertia ixx="${intertia_ixx}" ixy="${intertia_ixy}" ixz="${intertia_ixz}" iyy="${intertia_iyy}" iyz="${intertia_iyz}" izz="${intertia_izz}"/>
		</inertial>    
	</link>	
    
	<joint name="${prefix}joint4" type="revolute">
		<parent link="${prefix}link34" />
		<child link = "${prefix}link45" />
		<origin xyz="0 0 0.1695" rpy="0.0 0.0 0.0" />
		<axis xyz="0 0 1" />
		<limit lower="${joint4_lower_limit}" upper="${joint4_upper_limit}" effort="1000.0" velocity="${joint4_velocity_limit}"/>
		<dynamics damping="0.0" friction="0.0"/>
	</joint>

	<link name="${prefix}link45">
		<visual>
			<origin xyz="0 0 0" rpy="${pi/2.0} 0 0" />
			<geometry>
				<mesh filename="package://raw_description/meshes/p_rob_arm/link45.STL"/>
			</geometry>
			<material name="">
				<color rgba="0.898039215686275 0.917647058823529 0.929411764705882 1.0"/>
			</material>
		</visual>
		<collision>
			<origin xyz="0 0 0" rpy="${pi/2.0} 0 0" />
			<geometry>
				<mesh filename="package://raw_description/meshes/p_rob_arm/link45.STL"/>
			</geometry>
		</collision>
		<inertial>
			<origin xyz="8.71294630254049E-05 -0.313548704302934 -0.00113740271757783" rpy="0.0 0.0 0.0" />
			<mass value="${mass}"/>
			<inertia ixx="${intertia_ixx}" ixy="${intertia_ixy}" ixz="${intertia_ixz}" iyy="${intertia_iyy}" iyz="${intertia_iyz}" izz="${intertia_izz}"/>
		</inertial>    
	</link>
    
	<joint name="${prefix}joint5" type="revolute">
		<parent link="${prefix}link45" />
		<child link = "${prefix}link56" />
		<origin xyz="0 0 0.1405" rpy="0.0 0.0 0.0" />
		<axis xyz="0 1 0" />
		<limit lower="${joint5_lower_limit}" upper="${joint5_upper_limit}" effort="1000.0" velocity="${joint5_velocity_limit}"/>
		<dynamics damping="0.0" friction="0.0"/>
	</joint>

	<link name="${prefix}link56">
		<visual>
			<origin xyz="0 0 0.1405" rpy="${pi/2.0} 0 ${pi}" />
			<geometry>
				<mesh filename="package://raw_description/meshes/p_rob_arm/link56.STL"/>
			</geometry>
			<material name="">
				<color rgba="0.898039215686275 0.917647058823529 0.929411764705882 1.0"/>
			</material>
		</visual>
		<collision>
			<origin xyz="0 0 0.1405" rpy="${pi/2.0} 0 ${pi}" />
			<geometry>
				<mesh filename="package://raw_description/meshes/p_rob_arm/link56.STL"/>
			</geometry>
		</collision>
		<inertial>
			<origin xyz="-8.71294630254049E-05 -0.588048704302934 0.00113740271757783" rpy="0.0 0.0 0.0" />
			<mass value="${mass}"/>
			<inertia ixx="${intertia_ixx}" ixy="${intertia_ixy}" ixz="${intertia_ixz}" iyy="${intertia_iyy}" iyz="${intertia_iyz}" izz="${intertia_izz}"/>
		</inertial>    
	</link>

	<joint name="${prefix}joint6" type="revolute">
		<parent link="${prefix}link56" />
		<child link = "${prefix}link6G" />
		<origin xyz="0 0 0.134" rpy="0.0 0.0 0.0" />
		<axis xyz="0 0 1" />
		<limit lower="${joint6_lower_limit}" upper="${joint6_upper_limit}" effort="1000.0" velocity="${joint6_velocity_limit}"/>
		<dynamics damping="0.0" friction="0.0"/>
	</joint>

	<link name="${prefix}link6G">
		<visual>
			<origin xyz="0 0 0" rpy="${-pi/2.0} 0 ${-pi/2.0}" />
			<geometry>
				<mesh filename="package://raw_description/meshes/p_rob_arm/link6G.STL"/>
			</geometry>
			<material name="">
				<color rgba="0.898039215686275 0.917647058823529 0.929411764705882 1.0"/>
			</material>
		</visual>
		<collision>
			<origin xyz="0 0 0" rpy="${-pi/2.0} 0 ${-pi/2.0}" />
			<geometry>
				<mesh filename="package://raw_description/meshes/p_rob_arm/link6G.STL"/>
			</geometry>
		</collision>
		<inertial>
			<origin xyz="-0.00113740271757783 0.588048704302934 8.7129463025477E-05" rpy="0.0 0.0 0.0" />
			<mass value="${mass}"/>
			<inertia ixx="${intertia_ixx}" ixy="${intertia_ixy}" ixz="${intertia_ixz}" iyy="${intertia_iyy}" iyz="${intertia_iyz}" izz="${intertia_izz}"/>
		</inertial>    
	</link>

	<joint name="gripper" type="fixed">
		<parent link="${prefix}link6G" />
		<child link = "gripper" />
		<origin xyz="0 0 0.172" rpy="0.0 ${-pi/2.0} 0.0" />
		<axis xyz="0 0 0" />
		<limit lower="${gripper_lower_limit}" upper="${gripper_upper_limit}" effort="1000.0" velocity="${gripper_velocity_limit}"/>
		<dynamics damping="0.0" friction="0.0"/>
	</joint>


	<link name="gripper">
		<visual>
			<origin xyz="0 0 0" rpy="0 0 0" />
			<xacro:sphere_geometry radius="0.01"/>
		</visual>
		<collision>
			<origin xyz="0 0 0" rpy="0 0 0" />
			<xacro:sphere_geometry radius="0.01"/>
		</collision>
		<inertial>
			<origin xyz="0 0 0" rpy="0 0 0" />
			<mass value="0.01"/>
			<inertia ixx="${intertia_ixx}" ixy="${intertia_ixy}" ixz="${intertia_ixz}" iyy="${intertia_iyy}" iyz="${intertia_iyz}" izz="${intertia_izz}"/>
		</inertial>    
	</link>


  </xacro:macro>
  

  <xacro:macro name="cob4_arm" params="parent name *origin">

    <!-- instantiate the arm -->
    <xacro:p_rob_arm prefix=""/>

    <!-- mount the arm on the parent link -->
    <joint name="${name}_base_joint" type="fixed" >
      <parent link="${parent}" />
      <child link="${name}_base_link" />
      <xacro:insert_block name="origin" />
    </joint>


  </xacro:macro>
  
</robot>
